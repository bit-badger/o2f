<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>tres</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="A working example to demonstrate to C# developers how F# can improve their workflow and performance"/>
    <meta name="author" content="Daniel J. Summers"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/content/style.css" />
    <script type="text/javascript" src="/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/bit-badger/o2f">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/index.html">objects |> functions</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h3><a name="Tres-Step-4" class="anchor" href="#Tres-Step-4">Tres - Step 4</a></h3>
<h4><a name="Dependencies" class="anchor" href="#Dependencies">Dependencies</a></h4>
<p>As with <strong>Dos</strong>, we need a reference to <code>Nancy.Session.RavenDB</code>; we also are going to need a package called
<code>TaskBuilder.fs</code>. Both of these are already covered by the packages we already reference in <code>paket.dependencies</code>, so we
just need to add both of these to <code>paket.references</code>, then run <code>paket install</code>.</p>
<h4><a name="Boostrapper-Updates" class="anchor" href="#Boostrapper-Updates">Boostrapper Updates</a></h4>
<p>We need to add the <code>Certificate</code> and <code>Password</code> properties to our <code>DataConfig</code> record, so that we can use them to
configure our RavenDB connection. It becomes:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span class="rt">DataConfig</span> <span class="o">=</span>
  <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs32', 62)" onmouseover="showTip(event, 'fs32', 62)" class="id">Url</span>         <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs15', 63)" onmouseover="showTip(event, 'fs15', 63)" class="rt">string</span>
    <span onmouseout="hideTip(event, 'fs33', 64)" onmouseover="showTip(event, 'fs33', 64)" class="id">Database</span>    <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs15', 65)" onmouseover="showTip(event, 'fs15', 65)" class="rt">string</span>
    <span onmouseout="hideTip(event, 'fs34', 66)" onmouseover="showTip(event, 'fs34', 66)" class="id">Certificate</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs15', 67)" onmouseover="showTip(event, 'fs15', 67)" class="rt">string</span>
    <span onmouseout="hideTip(event, 'fs35', 68)" onmouseover="showTip(event, 'fs35', 68)" class="id">Password</span>    <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs15', 69)" onmouseover="showTip(event, 'fs15', 69)" class="rt">string</span>
    <span class="pn">}</span>
</code></pre></td>
</tr>
</table>
<p>Then, we'll convert our bootstrapper changes to F#. The bootstrapper is at the top of <code>App.fs</code>. We'll need to add some
<code>open</code> statements...</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="id">Nancy</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 82)" onmouseover="showTip(event, 'fs41', 82)" class="id">Session</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 83)" onmouseover="showTip(event, 'fs42', 83)" class="id">Persistable</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs39', 84)" onmouseover="showTip(event, 'fs39', 84)" class="id">Nancy</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 85)" onmouseover="showTip(event, 'fs41', 85)" class="id">Session</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs43', 86)" onmouseover="showTip(event, 'fs43', 86)" class="id">RavenDB</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs7', 87)" onmouseover="showTip(event, 'fs7', 87)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs44', 88)" onmouseover="showTip(event, 'fs44', 88)" class="id">Security</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs45', 89)" onmouseover="showTip(event, 'fs45', 89)" class="id">Cryptography</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs46', 90)" onmouseover="showTip(event, 'fs46', 90)" class="id">X509Certificates</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs47', 91)" onmouseover="showTip(event, 'fs47', 91)" class="d">TresBootstrapper</span> <span class="pn">(</span><span class="pn">)</span> <span class="o">=</span>
  <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs48', 92)" onmouseover="showTip(event, 'fs48', 92)" class="d">DefaultNancyBootstrapper</span> <span class="pn">(</span><span class="pn">)</span>

  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 93)" onmouseover="showTip(event, 'fs49', 93)" class="id">_store</span> <span class="o">=</span>
    <span class="fn">(</span><span class="k">lazy</span>
      <span class="pn">(</span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 94)" onmouseover="showTip(event, 'fs50', 94)" class="id">cfg</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs51', 95)" onmouseover="showTip(event, 'fs51', 95)" class="rt">File</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs52', 96)" onmouseover="showTip(event, 'fs52', 96)" class="id">ReadAllText</span> <span class="s">&quot;data-config.json&quot;</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs53', 97)" onmouseover="showTip(event, 'fs53', 97)" class="rt">JsonConvert</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs54', 98)" onmouseover="showTip(event, 'fs54', 98)" class="id">DeserializeObject</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs55', 99)" onmouseover="showTip(event, 'fs55', 99)" class="rt">DataConfig</span><span class="pn">&gt;</span>
      <span class="fn">(</span><span class="k">new</span> <span onmouseout="hideTip(event, 'fs56', 100)" onmouseover="showTip(event, 'fs56', 100)" class="d">DocumentStore</span> <span class="pn">(</span>
        <span class="id">Urls</span>        <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 101)" onmouseover="showTip(event, 'fs50', 101)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 102)" onmouseover="showTip(event, 'fs57', 102)" class="id">Urls</span><span class="pn">,</span>
        <span class="id">Database</span>    <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 103)" onmouseover="showTip(event, 'fs50', 103)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 104)" onmouseover="showTip(event, 'fs33', 104)" class="id">Database</span><span class="pn">,</span>
        <span class="id">Certificate</span> <span class="o">=</span>
          <span class="k">match</span> <span onmouseout="hideTip(event, 'fs58', 105)" onmouseover="showTip(event, 'fs58', 105)" class="fn">isNull</span> <span onmouseout="hideTip(event, 'fs50', 106)" onmouseover="showTip(event, 'fs50', 106)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 107)" onmouseover="showTip(event, 'fs34', 107)" class="id">Certificate</span> <span class="o">||</span> <span onmouseout="hideTip(event, 'fs50', 108)" onmouseover="showTip(event, 'fs50', 108)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 109)" onmouseover="showTip(event, 'fs34', 109)" class="id">Certificate</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="k">with</span>
          <span class="pn">|</span> <span class="k">true</span> <span class="k">-&gt;</span> <span class="k">null</span>
          <span class="pn">|</span> <span class="k">false</span> <span class="k">-&gt;</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs59', 110)" onmouseover="showTip(event, 'fs59', 110)" class="d">X509Certificate2</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs50', 111)" onmouseover="showTip(event, 'fs50', 111)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 112)" onmouseover="showTip(event, 'fs34', 112)" class="id">Certificate</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs50', 113)" onmouseover="showTip(event, 'fs50', 113)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 114)" onmouseover="showTip(event, 'fs35', 114)" class="id">Password</span><span class="pn">)</span><span class="pn">)</span><span class="pn">)</span><span class="pn">.</span><span class="id">Initialize</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">)</span><span class="pn">)</span><span class="pn">.</span><span class="id">Force</span> <span class="pn">(</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>This is F#'s version of lazy initialization. There are a lot more parentheses here, as we're creating objects and then
calling into their properties or methods. That's just a feature of how F# works. In C#,
<code>new DocumentStore().Initialize()</code> will work; in F#, though, we have to set off the creation of the document store like
<code>(new DocumentStore ()).Initialize ()</code>. <em>(The space before the <code>()</code> is optional, and these extra parentheses are
required whether it's there or not.)</em></p>
<p>Now, we can chage <code>ConfigureApplicationContainer</code> and bring across <code>ApplicationStartup</code>.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">  <span class="k">override</span> <span class="id">__</span><span class="pn">.</span><span class="fn">ConfigureApplicationContainer</span> <span onmouseout="hideTip(event, 'fs60', 115)" onmouseover="showTip(event, 'fs60', 115)" class="id">container</span> <span class="o">=</span>
    <span class="k">base</span><span class="pn">.</span><span class="id">ConfigureApplicationContainer</span> <span onmouseout="hideTip(event, 'fs60', 116)" onmouseover="showTip(event, 'fs60', 116)" class="id">container</span>
    <span onmouseout="hideTip(event, 'fs60', 117)" onmouseover="showTip(event, 'fs60', 117)" class="fn">container</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs61', 118)" onmouseover="showTip(event, 'fs61', 118)" class="id">Register</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs62', 119)" onmouseover="showTip(event, 'fs62', 119)" class="if">IDocumentStore</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs49', 120)" onmouseover="showTip(event, 'fs49', 120)" class="id">_store</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs63', 121)" onmouseover="showTip(event, 'fs63', 121)" class="fn">ignore</span>
  
  <span class="k">override</span> <span onmouseout="hideTip(event, 'fs64', 122)" onmouseover="showTip(event, 'fs64', 122)" class="id">__</span><span class="pn">.</span><span class="fn">ApplicationStartup</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs60', 123)" onmouseover="showTip(event, 'fs60', 123)" class="id">container</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs65', 124)" onmouseover="showTip(event, 'fs65', 124)" class="id">pipelines</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">base</span><span class="pn">.</span><span class="id">ApplicationStartup</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs60', 125)" onmouseover="showTip(event, 'fs60', 125)" class="id">container</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs65', 126)" onmouseover="showTip(event, 'fs65', 126)" class="id">pipelines</span><span class="pn">)</span><span class="pn">;</span>
    <span onmouseout="hideTip(event, 'fs66', 127)" onmouseover="showTip(event, 'fs66', 127)" class="rt">IndexCreation</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs67', 128)" onmouseover="showTip(event, 'fs67', 128)" class="id">CreateIndexes</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs68', 129)" onmouseover="showTip(event, 'fs68', 129)" class="k">typeof</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs10', 130)" onmouseover="showTip(event, 'fs10', 130)" class="rt">Categories_ByWebLogIdAndSlug</span><span class="pn">&gt;</span><span class="pn">.</span><span class="id">Assembly</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs49', 131)" onmouseover="showTip(event, 'fs49', 131)" class="id">_store</span><span class="pn">)</span>
    <span onmouseout="hideTip(event, 'fs69', 132)" onmouseover="showTip(event, 'fs69', 132)" class="rt">PersistableSessions</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs70', 133)" onmouseover="showTip(event, 'fs70', 133)" class="id">Enable</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs65', 134)" onmouseover="showTip(event, 'fs65', 134)" class="id">pipelines</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs71', 135)" onmouseover="showTip(event, 'fs71', 135)" class="rt">RavenDBSessionConfiguration</span> <span onmouseout="hideTip(event, 'fs49', 136)" onmouseover="showTip(event, 'fs49', 136)" class="id">_store</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>These are the same chages, just translated to F#.</p>
<h4><a name="Testing" class="anchor" href="#Testing">Testing</a></h4>
<p>As with <strong>Dos</strong>, we need to bring in the session extension method. Add <code>open Nancy.Session.Persistable</code> to the group of
<code>open</code> statements. C# only lets you define extension methods; however, F# allows you to define properties as well, so
<code>PersistableSession</code> is implemented as a <em>property</em> on Nancy's <code>Request</code> object. Then, we translate the function:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">    <span onmouseout="hideTip(event, 'fs73', 141)" onmouseover="showTip(event, 'fs73', 141)" class="mv">this</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs75', 142)" onmouseover="showTip(event, 'fs75', 142)" class="id">Get</span><span class="pn">(</span><span class="s">&quot;/&quot;</span><span class="pn">,</span> <span class="k">fun</span> <span class="id">_</span> <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 143)" onmouseover="showTip(event, 'fs76', 143)" class="id">count</span> <span class="o">=</span>
          <span class="pn">(</span><span onmouseout="hideTip(event, 'fs73', 144)" onmouseover="showTip(event, 'fs73', 144)" class="mv">this</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs77', 145)" onmouseover="showTip(event, 'fs77', 145)" class="id">Request</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs78', 146)" onmouseover="showTip(event, 'fs78', 146)" class="id">PersistableSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs79', 147)" onmouseover="showTip(event, 'fs79', 147)" class="id">Get</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs80', 148)" onmouseover="showTip(event, 'fs80', 148)" class="vt">Nullable</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs81', 149)" onmouseover="showTip(event, 'fs81', 149)" class="vt">int</span><span class="pn">&gt;</span><span class="pn">&gt;</span> <span class="s">&quot;Count&quot;</span>
           <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs82', 150)" onmouseover="showTip(event, 'fs82', 150)" class="m">Option</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs83', 151)" onmouseover="showTip(event, 'fs83', 151)" class="id">ofNullable</span>
           <span class="o">|&gt;</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs84', 152)" onmouseover="showTip(event, 'fs84', 152)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs85', 153)" onmouseover="showTip(event, 'fs85', 153)" class="id">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs85', 154)" onmouseover="showTip(event, 'fs85', 154)" class="id">x</span> <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs86', 155)" onmouseover="showTip(event, 'fs86', 155)" class="uc">None</span> <span class="k">-&gt;</span> <span class="n">0</span><span class="pn">)</span> <span class="o">+</span> <span class="n">1</span>
        <span onmouseout="hideTip(event, 'fs73', 156)" onmouseover="showTip(event, 'fs73', 156)" class="mv">this</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs77', 157)" onmouseover="showTip(event, 'fs77', 157)" class="id">Request</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs78', 158)" onmouseover="showTip(event, 'fs78', 158)" class="id">PersistableSession</span><span class="pn">.</span><span class="pn">[</span><span class="s">&quot;Count&quot;</span><span class="pn">]</span> <span class="k">&lt;-</span> <span onmouseout="hideTip(event, 'fs76', 159)" onmouseover="showTip(event, 'fs76', 159)" class="id">count</span>
        <span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 160)" onmouseover="showTip(event, 'fs27', 160)" class="fn">sprintf</span> <span class="s">&quot;You have visited this page </span><span class="pf">%i</span><span class="s"> times this session&quot;</span> <span onmouseout="hideTip(event, 'fs76', 161)" onmouseover="showTip(event, 'fs76', 161)" class="id">count</span><span class="pn">)</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs87', 162)" onmouseover="showTip(event, 'fs87', 162)" class="rt">obj</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>Since F# is designed to use <code>Option</code>s to represent a value that may or may not be present (rather than <code>null</code> checks),
but Nancy's sessions are designed to return <code>null</code> if a value isn't found, this is a bit more work. We have to specify
the full type (<code>Nullable&lt;int&gt;</code>), as F# doesn't support the trailing question mark syntax. Then, we use the <code>Option</code>
module's <code>ofNullable</code> function to convert a nullable value into an option. Finally, we use an inline function, which
behaves the same way as a <code>match</code> statement on the value it receives via the pipe operator.</p>
<p>As with <strong>Uno</strong> and <strong>Dos</strong>, if you run the site, you should be able to refresh and see the counter increase.</p>
<h4><a name="Data-Seeding" class="anchor" href="#Data-Seeding">Data Seeding</a></h4>
<p>The bulk of this process is simply bringing over the <code>HomeModule.Seed</code> method from <strong>Dos</strong>. However, before we take a
look at it, we need to take a quick side trip to discuss a concept we've seen in <strong>Cinco</strong> but have not explained yet.</p>
<h5><a name="Computation-Expressions" class="anchor" href="#Computation-Expressions">Computation Expressions</a></h5>
<p>In F#, a computation expression (CE) is an expression that can have one or more steps that produce a result. For each
type of result, there is a different type of CE. For example, there is a <code>seq</code> CE that generates a <code>sequence</code> (F#'s term
for <code>IEnumerable&lt;T&gt;</code>). Within a CE, you will find regular F# keywords such as <code>let</code>, <code>do</code>, and <code>match</code>; you will also
likely find a <code>return</code> keyword (which we don't normally use, because a function's last value is its implied return
value). You will also see keywords followed by an exclamation point - <code>let!</code>, <code>do!</code>, <code>match!</code>, and <code>return!</code>; these
keywords will have special meaning, and will directly affect whatever computation is being determined.</p>
<p>The <code>seq</code> CE also has a <code>yield</code> keyword, that acts like <code>yield return</code> does in C#; the <code>yield!</code> keyword yields each of
the items of an existing sequence. Below is an example <code>seq</code> CE, which contains the parts of a fake US phone number.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">    <span onmouseout="hideTip(event, 'fs89', 164)" onmouseover="showTip(event, 'fs89', 164)" class="k">seq</span> <span class="pn">{</span>
      <span class="k">yield</span> <span class="s">&quot;123&quot;</span>
      <span class="k">yield</span> <span class="s">&quot;555&quot;</span>
      <span class="k">yield</span> <span class="s">&quot;6789&quot;</span>
      <span class="pn">}</span>
</code></pre></td>
</tr>
</table>
<p>We could combine these using <code>let phone = x |&gt; Seq.reduce (+)</code>.</p>
<h5><a name="The-CE" class="anchor" href="#The-CE">The <code>task</code> CE</a></h5>
<p>F# provides an <code>async</code> CE that is used to define a workflow that can execute asynchronous processes together with others
to produce a result. However, F#'s <code>Async</code> behaves a bit differently than the .NET <code>Task</code> and <code>Task&lt;T&gt;</code> types. F#'s
<code>Async</code> module does have functions like <code>Async.AwaitTask</code> that bring tasks into the F# async world. But, if we were to
write an <code>await</code> function, it would look something like:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 165)" onmouseover="showTip(event, 'fs90', 165)" class="fn">await</span> <span onmouseout="hideTip(event, 'fs91', 166)" onmouseover="showTip(event, 'fs91', 166)" class="id">task</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs91', 167)" onmouseover="showTip(event, 'fs91', 167)" class="id">task</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs92', 168)" onmouseover="showTip(event, 'fs92', 168)" class="rt">Async</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs93', 169)" onmouseover="showTip(event, 'fs93', 169)" class="id">AwaitTask</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs92', 170)" onmouseover="showTip(event, 'fs92', 170)" class="rt">Async</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs94', 171)" onmouseover="showTip(event, 'fs94', 171)" class="id">RunSynchronously</span>
</code></pre></td>
</tr>
</table>
<p>This makes something like <code>let x = await (SomethingReturningATask())</code> or <code>let x = await &lt;| SomethingReturningATask()</code>.
However, that code doesn't flow very well; we either have to wrap the function/method calls in parentheses, or use
pipeline operators to send it to await. Also, this only works for <code>Task&lt;T&gt;</code>; we have to write a different one to
handle the non-generic <code>Task</code>.</p>
<p>Enter the <code>task</code> CE, provided by <code>TaskBuilder.fs</code>. It became popular as part of the Giraffe project, as Giraffe's
sitting atop ASP.NET Core required it to deal with tasks. Within a <code>task</code> CE, <code>let!</code> awaits a generic task, <code>do!</code>
awaits a non-generic task, <code>match!</code> awaits a generic task, then pattern-matches on the result, and <code>return!</code> awaits a
generic task and returns the result. <code>return</code> returns a regular value as the CE's result. The type of the <code>task</code> CE is
exactly what the rest of the .NET environment expects.</p>
<p>Take a look at <a href="https://github.com/bit-badger/o2f/tree/master/src/3-Tres/HomeModule.fs#L12">the <code>seed</code> function</a> to see
the <code>task</code> CE in action. <code>open FSharp.Control.Tasks.V2.ContextInsensitive</code> brings it into scope, and these tasks will
be run with <code>.ConfigureAwait(false)</code>; this keeps tasks from deadlocking from waiting on the same execution context.</p>
<p>One final note - the <code>:&gt; obj</code> at the bottom of the <code>seed</code> function makes the return type <code>Task&lt;obj&gt;</code> instead of
<code>Task&lt;string&gt;</code>, which is the required signature for <code>NancyModule</code>'s <code>Get</code> method.</p>
<h5><a name="But-Wait-There-s-More" class="anchor" href="#But-Wait-There-s-More">But Wait, There's More!</a></h5>
<p>Go ahead and run it at this point, go to <code>http://localhost:5000/seed</code>, and compare the RavenDB documents for posts or
pages against the ones created for <strong>Dos</strong>. You'll notice that the content types (our <code>IArticleContent</code> fields) do not
have the <code>ContentType</code> and <code>Text</code> properties! For some reason, this is serialized differently if it's part of an F#
record type. <em>(This may be an edge-case bug; if I can isolate the behavior, I'll submit an issue.)</em> However, this gives
us a chance for an early look at writing our own custom <code>JsonConverter</code>s. In step 3 <strong>Quatro</strong>, we added FSharpLu's
compact DU converter to RavenDB's configuration; this time, we'll write our own.</p>
<p>Just below the definition of <code>MarkdownArticleContent</code>, we'll create <code>IArticleContentConverter</code>, which will extend
<code>JsonConverter&lt;IArticleContent&gt;</code>. Generic converters need to implement two methods, <code>WriteJson</code> and <code>ReadJson</code>. Writing
is the easiest; and, since we have a <code>ContentType</code> property, we don't actually need to write the underlying CLR type to
the database. Here's the declaration, up through <code>WriteJson</code>.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs95', 172)" onmouseover="showTip(event, 'fs95', 172)" class="rt">IArticleContentConverter</span> <span class="pn">(</span><span class="pn">)</span> <span class="o">=</span>
  <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs96', 173)" onmouseover="showTip(event, 'fs96', 173)" class="rt">JsonConverter</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs21', 174)" onmouseover="showTip(event, 'fs21', 174)" class="if">IArticleContent</span><span class="pn">&gt;</span> <span class="pn">(</span><span class="pn">)</span>

  <span class="k">override</span> <span class="id">__</span><span class="pn">.</span><span class="fn">WriteJson</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs97', 175)" onmouseover="showTip(event, 'fs97', 175)" class="id">w</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs98', 176)" onmouseover="showTip(event, 'fs98', 176)" class="d">JsonWriter</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs99', 177)" onmouseover="showTip(event, 'fs99', 177)" class="id">v</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs21', 178)" onmouseover="showTip(event, 'fs21', 178)" class="if">IArticleContent</span><span class="pn">,</span> <span class="id">_</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs100', 179)" onmouseover="showTip(event, 'fs100', 179)" class="rt">JsonSerializer</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 180)" onmouseover="showTip(event, 'fs101', 180)" class="fn">writePair</span> <span onmouseout="hideTip(event, 'fs102', 181)" onmouseover="showTip(event, 'fs102', 181)" class="id">k</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs29', 182)" onmouseover="showTip(event, 'fs29', 182)" class="id">v</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs103', 183)" onmouseover="showTip(event, 'fs103', 183)" class="rt">string</span><span class="pn">)</span> <span class="o">=</span>
      <span onmouseout="hideTip(event, 'fs97', 184)" onmouseover="showTip(event, 'fs97', 184)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs104', 185)" onmouseover="showTip(event, 'fs104', 185)" class="id">WritePropertyName</span> <span onmouseout="hideTip(event, 'fs102', 186)" onmouseover="showTip(event, 'fs102', 186)" class="id">k</span>
      <span onmouseout="hideTip(event, 'fs97', 187)" onmouseover="showTip(event, 'fs97', 187)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs105', 188)" onmouseover="showTip(event, 'fs105', 188)" class="id">WriteValue</span>        <span onmouseout="hideTip(event, 'fs29', 189)" onmouseover="showTip(event, 'fs29', 189)" class="id">v</span>
    <span onmouseout="hideTip(event, 'fs97', 190)" onmouseover="showTip(event, 'fs97', 190)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs106', 191)" onmouseover="showTip(event, 'fs106', 191)" class="id">WriteStartObject</span> <span class="pn">(</span><span class="pn">)</span>
    <span onmouseout="hideTip(event, 'fs101', 192)" onmouseover="showTip(event, 'fs101', 192)" class="fn">writePair</span> <span class="s">&quot;ContentType&quot;</span> <span onmouseout="hideTip(event, 'fs99', 193)" onmouseover="showTip(event, 'fs99', 193)" class="id">v</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs107', 194)" onmouseover="showTip(event, 'fs107', 194)" class="id">ContentType</span>
    <span onmouseout="hideTip(event, 'fs101', 195)" onmouseover="showTip(event, 'fs101', 195)" class="fn">writePair</span> <span class="s">&quot;Text&quot;</span>        <span onmouseout="hideTip(event, 'fs99', 196)" onmouseover="showTip(event, 'fs99', 196)" class="id">v</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs108', 197)" onmouseover="showTip(event, 'fs108', 197)" class="id">Text</span>
    <span onmouseout="hideTip(event, 'fs97', 198)" onmouseover="showTip(event, 'fs97', 198)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs109', 199)" onmouseover="showTip(event, 'fs109', 199)" class="id">WriteEndObject</span> <span class="pn">(</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>Each <code>Write*</code> call in Json.NET writes a token; these tokens describe the shape of the JSON that will eventually be
serialized. Since we're intercepting a single property, but writing multiple values, we need to identify it as an
object. Then, we write two sets of property name and value tokens, and an end object token.</p>
<p>Reading it back is a bit different:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">  <span class="k">override</span> <span onmouseout="hideTip(event, 'fs110', 200)" onmouseover="showTip(event, 'fs110', 200)" class="id">__</span><span class="pn">.</span><span class="fn">ReadJson</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs111', 201)" onmouseover="showTip(event, 'fs111', 201)" class="id">r</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs112', 202)" onmouseover="showTip(event, 'fs112', 202)" class="d">JsonReader</span><span class="pn">,</span> <span class="id">_</span><span class="pn">,</span> <span class="id">_</span><span class="pn">,</span> <span class="id">_</span><span class="pn">,</span> <span class="id">_</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs113', 203)" onmouseover="showTip(event, 'fs113', 203)" class="fn">readIgnore</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs111', 204)" onmouseover="showTip(event, 'fs111', 204)" class="fn">r</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs114', 205)" onmouseover="showTip(event, 'fs114', 205)" class="id">Read</span> <span class="o">&gt;</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs63', 206)" onmouseover="showTip(event, 'fs63', 206)" class="fn">ignore</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs115', 207)" onmouseover="showTip(event, 'fs115', 207)" class="id">typ</span>  <span class="o">=</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs113', 208)" onmouseover="showTip(event, 'fs113', 208)" class="fn">readIgnore</span> <span class="o">&gt;</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs111', 209)" onmouseover="showTip(event, 'fs111', 209)" class="fn">r</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs116', 210)" onmouseover="showTip(event, 'fs116', 210)" class="id">ReadAsString</span><span class="pn">)</span> <span class="pn">(</span><span class="pn">)</span> <span class="c">// PropertyName -&gt; String</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs117', 211)" onmouseover="showTip(event, 'fs117', 211)" class="id">text</span> <span class="o">=</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs113', 212)" onmouseover="showTip(event, 'fs113', 212)" class="fn">readIgnore</span> <span class="o">&gt;</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs111', 213)" onmouseover="showTip(event, 'fs111', 213)" class="fn">r</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs116', 214)" onmouseover="showTip(event, 'fs116', 214)" class="id">ReadAsString</span><span class="pn">)</span> <span class="pn">(</span><span class="pn">)</span> <span class="c">// PropertyName -&gt; String</span>
    <span onmouseout="hideTip(event, 'fs113', 215)" onmouseover="showTip(event, 'fs113', 215)" class="fn">readIgnore</span> <span class="pn">(</span><span class="pn">)</span> <span class="c">// EndObject</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs118', 216)" onmouseover="showTip(event, 'fs118', 216)" class="id">content</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs21', 217)" onmouseover="showTip(event, 'fs21', 217)" class="if">IArticleContent</span> <span class="o">=</span>
      <span class="k">match</span> <span onmouseout="hideTip(event, 'fs115', 218)" onmouseover="showTip(event, 'fs115', 218)" class="id">typ</span> <span class="k">with</span>
      <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs22', 219)" onmouseover="showTip(event, 'fs22', 219)" class="m">ContentType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs19', 220)" onmouseover="showTip(event, 'fs19', 220)" class="id">Html</span> <span class="k">-&gt;</span> <span class="k">upcast</span> <span onmouseout="hideTip(event, 'fs25', 221)" onmouseover="showTip(event, 'fs25', 221)" class="rt">HtmlArticleContent</span> <span class="pn">(</span><span class="pn">)</span>
      <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs22', 222)" onmouseover="showTip(event, 'fs22', 222)" class="m">ContentType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 223)" onmouseover="showTip(event, 'fs20', 223)" class="id">Markdown</span> <span class="k">-&gt;</span> <span class="k">upcast</span> <span onmouseout="hideTip(event, 'fs30', 224)" onmouseover="showTip(event, 'fs30', 224)" class="rt">MarkdownArticleContent</span> <span class="pn">(</span><span class="pn">)</span>
      <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs119', 225)" onmouseover="showTip(event, 'fs119', 225)" class="id">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs120', 226)" onmouseover="showTip(event, 'fs120', 226)" class="fn">invalidOp</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 227)" onmouseover="showTip(event, 'fs27', 227)" class="fn">sprintf</span> <span class="s">&quot;Cannot deserialize </span><span class="pf">%s</span><span class="s"> into IArticleContent&quot;</span> <span onmouseout="hideTip(event, 'fs119', 228)" onmouseover="showTip(event, 'fs119', 228)" class="id">x</span><span class="pn">)</span>
    <span onmouseout="hideTip(event, 'fs118', 229)" onmouseover="showTip(event, 'fs118', 229)" class="id">content</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs108', 230)" onmouseover="showTip(event, 'fs108', 230)" class="id">Text</span> <span class="k">&lt;-</span> <span onmouseout="hideTip(event, 'fs117', 231)" onmouseover="showTip(event, 'fs117', 231)" class="id">text</span>
    <span onmouseout="hideTip(event, 'fs118', 232)" onmouseover="showTip(event, 'fs118', 232)" class="id">content</span>
</code></pre></td>
</tr>
</table>
<p>When <code>ReadJson</code> is called, the starting object token has already been read. We read the tokens back in the order in
which we wrote them, so we'll see a property name token, then a value token. We know the property that we wrote, so we
can ignore that token; then, we know the value that we wrote is a string, so we can read the next token's value as a
string. We'll repeat that process for the actual text, and then, we need one more read to advance the reader past the
end object token. Once we have our property values, the <code>ContentType</code> tells us what type of implementation to construct,
and we can use the <code>Text</code> setter on the <code>IArticleContent</code> interface to put the text in the object.</p>
<p>This can seem convoluted, but hopefully the comments above help somewhat. I learned about what I've explained in this
section when I encountered <em>this</em> problem for <em>this</em> project. Also, most of our other <code>JsonConverter</code>s will be simply
transforming the value as it's written and read, not writing an entire object based on the data type of the property.
Even this converter, though, easily fits on one screen, and thanks to F#'s function composition, it isn't repetitive;
nearly every line does something different.</p>
<p>We do need to revisit our RavenDB connection, though, as we need to actually plug our converter into the document store.
Here's the updated definition of <code>_store</code> from <code>App.fs</code>:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 234)" onmouseover="showTip(event, 'fs49', 234)" class="id">_store</span> <span class="o">=</span>
    <span class="fn">(</span><span class="k">lazy</span>
     <span class="pn">(</span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 235)" onmouseover="showTip(event, 'fs50', 235)" class="id">cfg</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs51', 236)" onmouseover="showTip(event, 'fs51', 236)" class="rt">File</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs122', 237)" onmouseover="showTip(event, 'fs122', 237)" class="id">ReadAllText</span> <span class="s">&quot;data-config.json&quot;</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs53', 238)" onmouseover="showTip(event, 'fs53', 238)" class="rt">JsonConvert</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs123', 239)" onmouseover="showTip(event, 'fs123', 239)" class="id">DeserializeObject</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs55', 240)" onmouseover="showTip(event, 'fs55', 240)" class="rt">DataConfig</span><span class="pn">&gt;</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs124', 241)" onmouseover="showTip(event, 'fs124', 241)" class="id">store</span> <span class="o">=</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs56', 242)" onmouseover="showTip(event, 'fs56', 242)" class="d">DocumentStore</span> <span class="pn">(</span>
          <span class="id">Urls</span>        <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 243)" onmouseover="showTip(event, 'fs50', 243)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 244)" onmouseover="showTip(event, 'fs57', 244)" class="id">Urls</span><span class="pn">,</span>
          <span class="id">Database</span>    <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 245)" onmouseover="showTip(event, 'fs50', 245)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 246)" onmouseover="showTip(event, 'fs33', 246)" class="id">Database</span><span class="pn">,</span>
          <span class="id">Certificate</span> <span class="o">=</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs58', 247)" onmouseover="showTip(event, 'fs58', 247)" class="fn">isNull</span> <span onmouseout="hideTip(event, 'fs50', 248)" onmouseover="showTip(event, 'fs50', 248)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 249)" onmouseover="showTip(event, 'fs34', 249)" class="id">Certificate</span> <span class="o">||</span> <span onmouseout="hideTip(event, 'fs50', 250)" onmouseover="showTip(event, 'fs50', 250)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 251)" onmouseover="showTip(event, 'fs34', 251)" class="id">Certificate</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="k">with</span>
            <span class="pn">|</span> <span class="k">true</span> <span class="k">-&gt;</span> <span class="k">null</span>
            <span class="pn">|</span> <span class="k">false</span> <span class="k">-&gt;</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs125', 252)" onmouseover="showTip(event, 'fs125', 252)" class="d">X509Certificate2</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs50', 253)" onmouseover="showTip(event, 'fs50', 253)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 254)" onmouseover="showTip(event, 'fs34', 254)" class="id">Certificate</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs50', 255)" onmouseover="showTip(event, 'fs50', 255)" class="id">cfg</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 256)" onmouseover="showTip(event, 'fs35', 256)" class="id">Password</span><span class="pn">)</span><span class="pn">)</span>
      <span onmouseout="hideTip(event, 'fs124', 257)" onmouseover="showTip(event, 'fs124', 257)" class="id">store</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs126', 258)" onmouseover="showTip(event, 'fs126', 258)" class="id">Conventions</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs127', 259)" onmouseover="showTip(event, 'fs127', 259)" class="id">CustomizeJsonSerializer</span> <span class="k">&lt;-</span>
        <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs128', 260)" onmouseover="showTip(event, 'fs128', 260)" class="id">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs128', 261)" onmouseover="showTip(event, 'fs128', 261)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs129', 262)" onmouseover="showTip(event, 'fs129', 262)" class="id">Converters</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs130', 263)" onmouseover="showTip(event, 'fs130', 263)" class="id">Add</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs95', 264)" onmouseover="showTip(event, 'fs95', 264)" class="rt">IArticleContentConverter</span> <span class="pn">(</span><span class="pn">)</span><span class="pn">)</span>
      <span onmouseout="hideTip(event, 'fs124', 265)" onmouseover="showTip(event, 'fs124', 265)" class="fn">store</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs131', 266)" onmouseover="showTip(event, 'fs131', 266)" class="id">Initialize</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">)</span><span class="pn">)</span><span class="pn">.</span><span class="id">Force</span> <span class="pn">(</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>At this point, use RavenDB studio to delete the existing documents, re-run the application, and re-seed the database.
You should now see <code>ContentType</code> and <code>Text</code> fields under the page/post's <code>Text</code> and <code>Revision</code> properties.</p>
<h4><a name="Conclusion" class="anchor" href="#Conclusion">Conclusion</a></h4>
<p>We did another C# to F# translation. We also learned about computation expressions in general, the <code>task</code> CE
specifically, and how to write a non-trivial JSON converter. Nice job - now, on to <strong>Quatro</strong>!</p>
<hr />
<p><a href="../step4">Back to step 4</a></p>

<div class="tip" id="fs1">namespace Newtonsoft</div>
<div class="tip" id="fs2">namespace Newtonsoft.Json</div>
<div class="tip" id="fs3">namespace Raven</div>
<div class="tip" id="fs4">namespace Raven.Client</div>
<div class="tip" id="fs5">namespace Raven.Client.Documents</div>
<div class="tip" id="fs6">namespace Raven.Client.Documents.Indexes</div>
<div class="tip" id="fs7">namespace System</div>
<div class="tip" id="fs8">namespace System.Collections</div>
<div class="tip" id="fs9">namespace System.Collections.Generic</div>
<div class="tip" id="fs10">Multiple items<br />type Categories_ByWebLogIdAndSlug =<br />&#160;&#160;inherit AbstractJavaScriptIndexCreationTask<br />&#160;&#160;new : unit -&gt; Categories_ByWebLogIdAndSlug<br /><br />--------------------<br />new : unit -&gt; Categories_ByWebLogIdAndSlug</div>
<div class="tip" id="fs11">val this : Categories_ByWebLogIdAndSlug</div>
<div class="tip" id="fs12">Multiple items<br />type AbstractJavaScriptIndexCreationTask =<br />&#160;&#160;inherit AbstractIndexCreationTask<br />&#160;&#160;member CreateIndexDefinition : unit -&gt; IndexDefinition<br />&#160;&#160;member Fields : Dictionary&lt;string, IndexFieldOptions&gt; with get, set<br />&#160;&#160;member IsMapReduce : bool<br />&#160;&#160;member Maps : HashSet&lt;string&gt; with get, set<br /><br />--------------------<br />AbstractJavaScriptIndexCreationTask() : AbstractJavaScriptIndexCreationTask</div>
<div class="tip" id="fs13">property AbstractJavaScriptIndexCreationTask.Maps: HashSet&lt;string&gt;</div>
<div class="tip" id="fs14">Multiple items<br />type HashSet&lt;&#39;T&gt; =<br />&#160;&#160;new : unit -&gt; HashSet&lt;&#39;T&gt; + 3 overloads<br />&#160;&#160;member Add : item:&#39;T -&gt; bool<br />&#160;&#160;member Clear : unit -&gt; unit<br />&#160;&#160;member Comparer : IEqualityComparer&lt;&#39;T&gt;<br />&#160;&#160;member Contains : item:&#39;T -&gt; bool<br />&#160;&#160;member CopyTo : array:&#39;T[] -&gt; unit + 2 overloads<br />&#160;&#160;member Count : int<br />&#160;&#160;member ExceptWith : other:IEnumerable&lt;&#39;T&gt; -&gt; unit<br />&#160;&#160;member GetEnumerator : unit -&gt; Enumerator&lt;&#39;T&gt;<br />&#160;&#160;member GetObjectData : info:SerializationInfo * context:StreamingContext -&gt; unit<br />&#160;&#160;...<br />&#160;&#160;nested type Enumerator<br /><br />--------------------<br />HashSet() : HashSet&lt;&#39;T&gt;<br />HashSet(comparer: IEqualityComparer&lt;&#39;T&gt;) : HashSet&lt;&#39;T&gt;<br />HashSet(collection: IEnumerable&lt;&#39;T&gt;) : HashSet&lt;&#39;T&gt;<br />HashSet(collection: IEnumerable&lt;&#39;T&gt;, comparer: IEqualityComparer&lt;&#39;T&gt;) : HashSet&lt;&#39;T&gt;</div>
<div class="tip" id="fs15">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />--------------------<br />type string = System.String</div>
<div class="tip" id="fs16">Multiple items<br />type AutoOpenAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; AutoOpenAttribute<br />&#160;&#160;new : path:string -&gt; AutoOpenAttribute<br />&#160;&#160;member Path : string<br /><br />--------------------<br />new : unit -&gt; AutoOpenAttribute<br />new : path:string -&gt; AutoOpenAttribute</div>
<div class="tip" id="fs17">Multiple items<br />type RequireQualifiedAccessAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; RequireQualifiedAccessAttribute<br /><br />--------------------<br />new : unit -&gt; RequireQualifiedAccessAttribute</div>
<div class="tip" id="fs18">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs19">val Html : string</div>
<div class="tip" id="fs20">val Markdown : string</div>
<div class="tip" id="fs21">type IArticleContent =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;abstract member Generate : unit -&gt; string<br />&#160;&#160;&#160;&#160;abstract member ContentType : string<br />&#160;&#160;&#160;&#160;abstract member Text : string<br />&#160;&#160;&#160;&#160;abstract member Text : string with set<br />&#160;&#160;end</div>
<div class="tip" id="fs22">module ContentType<br /><br />from Tres.Domain</div>
<div class="tip" id="fs23">val set : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt; (requires comparison)</div>
<div class="tip" id="fs24">type unit = Unit</div>
<div class="tip" id="fs25">Multiple items<br />type HtmlArticleContent =<br />&#160;&#160;interface IArticleContent<br />&#160;&#160;new : unit -&gt; HtmlArticleContent<br />&#160;&#160;override ToString : unit -&gt; string<br /><br />--------------------<br />new : unit -&gt; HtmlArticleContent</div>
<div class="tip" id="fs26">val mutable text : string</div>
<div class="tip" id="fs27">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs28">val __ : HtmlArticleContent</div>
<div class="tip" id="fs29">val v : string</div>
<div class="tip" id="fs30">Multiple items<br />type MarkdownArticleContent =<br />&#160;&#160;interface IArticleContent<br />&#160;&#160;new : unit -&gt; MarkdownArticleContent<br />&#160;&#160;override ToString : unit -&gt; string<br /><br />--------------------<br />new : unit -&gt; MarkdownArticleContent</div>
<div class="tip" id="fs31">val __ : MarkdownArticleContent</div>
<div class="tip" id="fs32">DataConfig.Url: string</div>
<div class="tip" id="fs33">DataConfig.Database: string</div>
<div class="tip" id="fs34">DataConfig.Certificate: string</div>
<div class="tip" id="fs35">DataConfig.Password: string</div>
<div class="tip" id="fs36">Multiple items<br />type JsonIgnoreAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; JsonIgnoreAttribute<br /><br />--------------------<br />JsonIgnoreAttribute() : JsonIgnoreAttribute</div>
<div class="tip" id="fs37">val this : DataConfig</div>
<div class="tip" id="fs38">module Indexes<br /><br />from Tres</div>
<div class="tip" id="fs39">namespace Nancy</div>
<div class="tip" id="fs40">namespace System.IO</div>
<div class="tip" id="fs41">namespace Nancy.Session</div>
<div class="tip" id="fs42">namespace Nancy.Session.Persistable</div>
<div class="tip" id="fs43">namespace Nancy.Session.RavenDB</div>
<div class="tip" id="fs44">namespace System.Security</div>
<div class="tip" id="fs45">namespace System.Security.Cryptography</div>
<div class="tip" id="fs46">namespace System.Security.Cryptography.X509Certificates</div>
<div class="tip" id="fs47">Multiple items<br />type TresBootstrapper =<br />&#160;&#160;inherit DefaultNancyBootstrapper<br />&#160;&#160;new : unit -&gt; TresBootstrapper<br />&#160;&#160;override ApplicationStartup : container:TinyIoCContainer * pipelines:IPipelines -&gt; unit<br />&#160;&#160;override ConfigureApplicationContainer : container:TinyIoCContainer -&gt; unit<br /><br />--------------------<br />new : unit -&gt; TresBootstrapper</div>
<div class="tip" id="fs48">Multiple items<br />type DefaultNancyBootstrapper =<br />&#160;&#160;inherit NancyBootstrapperWithRequestContainerBase&lt;TinyIoCContainer&gt;<br />&#160;&#160;new : unit -&gt; DefaultNancyBootstrapper<br />&#160;&#160;member GetEnvironment : unit -&gt; INancyEnvironment<br />&#160;&#160;static val DefaultAutoRegisterIgnoredAssemblies : IEnumerable&lt;Func&lt;Assembly, bool&gt;&gt;<br /><br />--------------------<br />DefaultNancyBootstrapper() : DefaultNancyBootstrapper</div>
<div class="tip" id="fs49">val _store : IDocumentStore</div>
<div class="tip" id="fs50">val cfg : DataConfig</div>
<div class="tip" id="fs51">type File =<br />&#160;&#160;static member AppendAllLines : path:string * contents:IEnumerable&lt;string&gt; -&gt; unit + 1 overload<br />&#160;&#160;static member AppendAllText : path:string * contents:string -&gt; unit + 1 overload<br />&#160;&#160;static member AppendText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Copy : sourceFileName:string * destFileName:string -&gt; unit + 1 overload<br />&#160;&#160;static member Create : path:string -&gt; FileStream + 3 overloads<br />&#160;&#160;static member CreateText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Decrypt : path:string -&gt; unit<br />&#160;&#160;static member Delete : path:string -&gt; unit<br />&#160;&#160;static member Encrypt : path:string -&gt; unit<br />&#160;&#160;static member Exists : path:string -&gt; bool<br />&#160;&#160;...</div>
<div class="tip" id="fs52">File.ReadAllText(path: string) : string<br />File.ReadAllText(path: string, encoding: System.Text.Encoding) : string</div>
<div class="tip" id="fs53">type JsonConvert =<br />&#160;&#160;static val True : string<br />&#160;&#160;static val False : string<br />&#160;&#160;static val Null : string<br />&#160;&#160;static val Undefined : string<br />&#160;&#160;static val PositiveInfinity : string<br />&#160;&#160;static val NegativeInfinity : string<br />&#160;&#160;static val NaN : string<br />&#160;&#160;static member DefaultSettings : Func&lt;JsonSerializerSettings&gt; with get, set<br />&#160;&#160;static member DeserializeAnonymousType&lt;&#39;T&gt; : value:string * anonymousTypeObject:&#39;T -&gt; &#39;T + 1 overload<br />&#160;&#160;static member DeserializeObject : value:string -&gt; obj + 7 overloads<br />&#160;&#160;...</div>
<div class="tip" id="fs54">JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string) : &#39;T<br />JsonConvert.DeserializeObject(value: string) : obj<br />JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string, settings: JsonSerializerSettings) : &#39;T<br />JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string, [&lt;System.ParamArray&gt;] converters: JsonConverter []) : &#39;T<br />JsonConvert.DeserializeObject(value: string, type: System.Type) : obj<br />JsonConvert.DeserializeObject(value: string, settings: JsonSerializerSettings) : obj<br />JsonConvert.DeserializeObject(value: string, type: System.Type, settings: JsonSerializerSettings) : obj<br />JsonConvert.DeserializeObject(value: string, type: System.Type, [&lt;System.ParamArray&gt;] converters: JsonConverter []) : obj</div>
<div class="tip" id="fs55">type DataConfig =<br />&#160;&#160;{Url: string;<br />&#160;&#160;&#160;Database: string;<br />&#160;&#160;&#160;Certificate: string;<br />&#160;&#160;&#160;Password: string;}<br />&#160;&#160;&#160;&#160;member Urls : string []</div>
<div class="tip" id="fs56">Multiple items<br />type DocumentStore =<br />&#160;&#160;inherit DocumentStoreBase<br />&#160;&#160;new : unit -&gt; DocumentStore<br />&#160;&#160;member AggressivelyCacheFor : cacheDuration:TimeSpan * ?database:string -&gt; IDisposable + 1 overload<br />&#160;&#160;member BulkInsert : ?database:string * ?token:CancellationToken -&gt; BulkInsertOperation<br />&#160;&#160;member Changes : ?database:string -&gt; IDatabaseChanges + 1 overload<br />&#160;&#160;member DisableAggressiveCaching : ?database:string -&gt; IDisposable<br />&#160;&#160;member Dispose : unit -&gt; unit<br />&#160;&#160;member GetLastDatabaseChangesStateException : ?database:string * ?nodeTag:string -&gt; Exception<br />&#160;&#160;member GetRequestExecutor : ?database:string -&gt; RequestExecutor<br />&#160;&#160;member Identifier : string with get, set<br />&#160;&#160;member Initialize : unit -&gt; IDocumentStore<br />&#160;&#160;...<br /><br />--------------------<br />DocumentStore() : DocumentStore</div>
<div class="tip" id="fs57">property DataConfig.Urls: string []</div>
<div class="tip" id="fs58">val isNull : value:&#39;T -&gt; bool (requires &#39;T : null)</div>
<div class="tip" id="fs59">Multiple items<br />type X509Certificate2 =<br />&#160;&#160;inherit X509Certificate<br />&#160;&#160;new : unit -&gt; X509Certificate2 + 12 overloads<br />&#160;&#160;member Archived : bool with get, set<br />&#160;&#160;member Extensions : X509ExtensionCollection<br />&#160;&#160;member FriendlyName : string with get, set<br />&#160;&#160;member GetNameInfo : nameType:X509NameType * forIssuer:bool -&gt; string<br />&#160;&#160;member HasPrivateKey : bool<br />&#160;&#160;member Import : rawData:byte[] -&gt; unit + 5 overloads<br />&#160;&#160;member IssuerName : X500DistinguishedName<br />&#160;&#160;member NotAfter : DateTime<br />&#160;&#160;member NotBefore : DateTime<br />&#160;&#160;...<br /><br />--------------------<br />X509Certificate2() : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte []) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(handle: nativeint) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(certificate: X509Certificate) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: System.Security.SecureString) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: System.Security.SecureString) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string, keyStorageFlags: X509KeyStorageFlags) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs60">val container : TinyIoc.TinyIoCContainer</div>
<div class="tip" id="fs61">TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType,&#39;RegisterImplementation (requires reference type and reference type and &#39;RegisterImplementation :&gt; &#39;RegisterType)&gt;() : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType (requires reference type)&gt;() : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType (requires reference type)&gt;(factory: System.Func&lt;TinyIoc.TinyIoCContainer,TinyIoc.NamedParameterOverloads,&#39;RegisterType&gt;) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType,&#39;RegisterImplementation (requires reference type and reference type and &#39;RegisterImplementation :&gt; &#39;RegisterType)&gt;(instance: &#39;RegisterImplementation) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType (requires reference type)&gt;(instance: &#39;RegisterType) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType,&#39;RegisterImplementation (requires reference type and reference type and &#39;RegisterImplementation :&gt; &#39;RegisterType)&gt;(name: string) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType (requires reference type)&gt;(name: string) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register(registerType: System.Type) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType (requires reference type)&gt;(factory: System.Func&lt;TinyIoc.TinyIoCContainer,TinyIoc.NamedParameterOverloads,&#39;RegisterType&gt;, name: string) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />TinyIoc.TinyIoCContainer.Register&lt;&#39;RegisterType,&#39;RegisterImplementation (requires reference type and reference type and &#39;RegisterImplementation :&gt; &#39;RegisterType)&gt;(instance: &#39;RegisterImplementation, name: string) : TinyIoc.TinyIoCContainer.RegisterOptions<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs62">type IDocumentStore =<br />&#160;&#160;inherit IDisposalNotification<br />&#160;&#160;inherit IDisposable<br />&#160;&#160;member AggressivelyCache : ?database:string -&gt; IDisposable<br />&#160;&#160;member AggressivelyCacheFor : cacheDuration:TimeSpan * ?database:string -&gt; IDisposable + 1 overload<br />&#160;&#160;member BulkInsert : ?database:string * ?token:CancellationToken -&gt; BulkInsertOperation<br />&#160;&#160;member Certificate : X509Certificate2<br />&#160;&#160;member Changes : ?database:string -&gt; IDatabaseChanges + 1 overload<br />&#160;&#160;member Conventions : DocumentConventions<br />&#160;&#160;member Database : string with get, set<br />&#160;&#160;member DisableAggressiveCaching : ?database:string -&gt; IDisposable<br />&#160;&#160;member ExecuteIndex : task:AbstractIndexCreationTask * ?database:string -&gt; unit<br />&#160;&#160;member ExecuteIndexAsync : task:AbstractIndexCreationTask * ?database:string * ?token:CancellationToken -&gt; Task<br />&#160;&#160;...</div>
<div class="tip" id="fs63">val ignore : value:&#39;T -&gt; unit</div>
<div class="tip" id="fs64">val __ : TresBootstrapper</div>
<div class="tip" id="fs65">val pipelines : Bootstrapper.IPipelines</div>
<div class="tip" id="fs66">type IndexCreation =<br />&#160;&#160;static member CreateIndexes : assemblyToScan:Assembly * store:IDocumentStore * ?conventions:DocumentConventions * ?database:string -&gt; unit + 1 overload<br />&#160;&#160;static member CreateIndexesAsync : assemblyToScan:Assembly * store:IDocumentStore * ?conventions:DocumentConventions * ?database:string * ?token:CancellationToken -&gt; Task + 1 overload</div>
<div class="tip" id="fs67">IndexCreation.CreateIndexes(indexes: System.Collections.Generic.IEnumerable&lt;AbstractIndexCreationTask&gt;, store: IDocumentStore,?conventions: Conventions.DocumentConventions,?database: string) : unit<br />IndexCreation.CreateIndexes(assemblyToScan: System.Reflection.Assembly, store: IDocumentStore,?conventions: Conventions.DocumentConventions,?database: string) : unit</div>
<div class="tip" id="fs68">val typeof&lt;&#39;T&gt; : System.Type</div>
<div class="tip" id="fs69">Multiple items<br />type PersistableSessions =<br />&#160;&#160;new : cfg:IPersistableSessionConfiguration -&gt; PersistableSessions<br />&#160;&#160;member Load : request:Request -&gt; IPersistableSession<br />&#160;&#160;member Save : session:IPersistableSession -&gt; response:Response -&gt; unit<br />&#160;&#160;static member Enable : pipelines:IPipelines * cfg:IPersistableSessionConfiguration -&gt; unit<br />&#160;&#160;static member private LoadSession : ctx:NancyContext -&gt; provider:PersistableSessions -&gt; Response<br />&#160;&#160;static member private SaveSession : ctx:NancyContext -&gt; provider:PersistableSessions -&gt; unit<br /><br />--------------------<br />new : cfg:IPersistableSessionConfiguration -&gt; PersistableSessions</div>
<div class="tip" id="fs70">static member PersistableSessions.Enable : pipelines:Bootstrapper.IPipelines * cfg:IPersistableSessionConfiguration -&gt; unit</div>
<div class="tip" id="fs71">Multiple items<br />type RavenDBSessionConfiguration =<br />&#160;&#160;inherit BasePersistableSessionConfiguration<br />&#160;&#160;new : unit -&gt; RavenDBSessionConfiguration<br />&#160;&#160;new : store:IDocumentStore -&gt; RavenDBSessionConfiguration<br />&#160;&#160;new : store:IDocumentStore * cryptoConfig:CryptographyConfiguration -&gt; RavenDBSessionConfiguration<br />&#160;&#160;member Collection : string<br />&#160;&#160;member Database : string<br />&#160;&#160;member DocumentStore : IDocumentStore<br />&#160;&#160;override Store : IPersistableSessionStore<br />&#160;&#160;member Collection : string with set<br />&#160;&#160;member Database : string with set<br />&#160;&#160;...<br /><br />--------------------<br />new : unit -&gt; RavenDBSessionConfiguration<br />new : store:IDocumentStore -&gt; RavenDBSessionConfiguration<br />new : store:IDocumentStore * cryptoConfig:Cryptography.CryptographyConfiguration -&gt; RavenDBSessionConfiguration</div>
<div class="tip" id="fs72">Multiple items<br />type HomeModule =<br />&#160;&#160;inherit NancyModule<br />&#160;&#160;new : unit -&gt; HomeModule<br /><br />--------------------<br />new : unit -&gt; HomeModule</div>
<div class="tip" id="fs73">val this : HomeModule</div>
<div class="tip" id="fs74">Multiple items<br />type NancyModule =<br />&#160;&#160;member After : AfterPipeline with get, set<br />&#160;&#160;member Before : BeforePipeline with get, set<br />&#160;&#160;member Context : NancyContext with get, set<br />&#160;&#160;member Delete : path:string * action:Func&lt;obj, obj&gt; * ?condition:Func&lt;NancyContext, bool&gt; * ?name:string -&gt; unit + 5 overloads<br />&#160;&#160;member Get : path:string * action:Func&lt;obj, obj&gt; * ?condition:Func&lt;NancyContext, bool&gt; * ?name:string -&gt; unit + 5 overloads<br />&#160;&#160;member Head : path:string * action:Func&lt;obj, obj&gt; * ?condition:Func&lt;NancyContext, bool&gt; * ?name:string -&gt; unit + 5 overloads<br />&#160;&#160;member ModelBinderLocator : IModelBinderLocator with get, set<br />&#160;&#160;member ModelValidationResult : ModelValidationResult with get, set<br />&#160;&#160;member ModulePath : string with get, set<br />&#160;&#160;member Negotiate : Negotiator<br />&#160;&#160;...<br /><br />--------------------<br />NancyModule() : NancyModule<br />NancyModule(modulePath: string) : NancyModule</div>
<div class="tip" id="fs75">NancyModule.Get&lt;&#39;T&gt;(path: string, action: Func&lt;obj,Threading.CancellationToken,Threading.Tasks.Task&lt;&#39;T&gt;&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit<br />NancyModule.Get(path: string, action: Func&lt;obj,Threading.CancellationToken,Threading.Tasks.Task&lt;obj&gt;&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit<br />NancyModule.Get&lt;&#39;T&gt;(path: string, action: Func&lt;obj,Threading.Tasks.Task&lt;&#39;T&gt;&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit<br />NancyModule.Get(path: string, action: Func&lt;obj,Threading.Tasks.Task&lt;obj&gt;&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit<br />NancyModule.Get&lt;&#39;T&gt;(path: string, action: Func&lt;obj,&#39;T&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit<br />NancyModule.Get(path: string, action: Func&lt;obj,obj&gt;,?condition: Func&lt;NancyContext,bool&gt;,?name: string) : unit</div>
<div class="tip" id="fs76">val count : int</div>
<div class="tip" id="fs77">property NancyModule.Request: Request</div>
<div class="tip" id="fs78">property Request.PersistableSession: IPersistableSession</div>
<div class="tip" id="fs79">abstract member IPersistableSession.Get : string -&gt; &#39;T</div>
<div class="tip" id="fs80">Multiple items<br />type Nullable =<br />&#160;&#160;static member Compare&lt;&#39;T&gt; : n1:Nullable&lt;&#39;T&gt; * n2:Nullable&lt;&#39;T&gt; -&gt; int<br />&#160;&#160;static member Equals&lt;&#39;T&gt; : n1:Nullable&lt;&#39;T&gt; * n2:Nullable&lt;&#39;T&gt; -&gt; bool<br />&#160;&#160;static member GetUnderlyingType : nullableType:Type -&gt; Type<br /><br />--------------------<br />type Nullable&lt;&#39;T (requires default constructor and value type and &#39;T :&gt; ValueType)&gt; =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : value:&#39;T -&gt; Nullable&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;member Equals : other:obj -&gt; bool<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetValueOrDefault : unit -&gt; &#39;T + 1 overload<br />&#160;&#160;&#160;&#160;member HasValue : bool<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;&#160;&#160;member Value : &#39;T<br />&#160;&#160;end<br /><br />--------------------<br />Nullable ()<br />Nullable(value: &#39;T) : Nullable&lt;&#39;T&gt;</div>
<div class="tip" id="fs81">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />--------------------<br />type int = int32<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int</div>
<div class="tip" id="fs82">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs83">val ofNullable : value:Nullable&lt;&#39;T&gt; -&gt; &#39;T option (requires default constructor and value type and &#39;T :&gt; ValueType)</div>
<div class="tip" id="fs84">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs85">val x : int</div>
<div class="tip" id="fs86">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs87">type obj = Object</div>
<div class="tip" id="fs88">val x : seq&lt;string&gt;</div>
<div class="tip" id="fs89">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = Collections.Generic.IEnumerable&lt;&#39;T&gt;</div>
<div class="tip" id="fs90">val await : task:Threading.Tasks.Task&lt;&#39;a&gt; -&gt; &#39;a</div>
<div class="tip" id="fs91">val task : Threading.Tasks.Task&lt;&#39;a&gt;</div>
<div class="tip" id="fs92">Multiple items<br />type Async =<br />&#160;&#160;static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />&#160;&#160;static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />&#160;&#160;static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />&#160;&#160;static member AwaitTask : task:Task -&gt; Async&lt;unit&gt;<br />&#160;&#160;static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />&#160;&#160;static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />&#160;&#160;static member CancelDefaultToken : unit -&gt; unit<br />&#160;&#160;static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />&#160;&#160;static member Choice : computations:seq&lt;Async&lt;&#39;T option&gt;&gt; -&gt; Async&lt;&#39;T option&gt;<br />&#160;&#160;static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />&#160;&#160;...<br /><br />--------------------<br />type Async&lt;&#39;T&gt; =</div>
<div class="tip" id="fs93">static member Async.AwaitTask : task:Threading.Tasks.Task -&gt; Async&lt;unit&gt;<br />static member Async.AwaitTask : task:Threading.Tasks.Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;</div>
<div class="tip" id="fs94">static member Async.RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:Threading.CancellationToken -&gt; &#39;T</div>
<div class="tip" id="fs95">Multiple items<br />type IArticleContentConverter =<br />&#160;&#160;inherit JsonConverter&lt;IArticleContent&gt;<br />&#160;&#160;new : unit -&gt; IArticleContentConverter<br />&#160;&#160;override ReadJson : r:JsonReader * Type * IArticleContent * bool * JsonSerializer -&gt; IArticleContent<br />&#160;&#160;override WriteJson : w:JsonWriter * v:IArticleContent * JsonSerializer -&gt; unit<br /><br />--------------------<br />new : unit -&gt; IArticleContentConverter</div>
<div class="tip" id="fs96">Multiple items<br />type JsonConverter =<br />&#160;&#160;member CanConvert : objectType:Type -&gt; bool<br />&#160;&#160;member CanRead : bool<br />&#160;&#160;member CanWrite : bool<br />&#160;&#160;member ReadJson : reader:JsonReader * objectType:Type * existingValue:obj * serializer:JsonSerializer -&gt; obj<br />&#160;&#160;member WriteJson : writer:JsonWriter * value:obj * serializer:JsonSerializer -&gt; unit<br /><br />--------------------<br />type JsonConverter&lt;&#39;T&gt; =<br />&#160;&#160;inherit JsonConverter<br />&#160;&#160;member CanConvert : objectType:Type -&gt; bool<br />&#160;&#160;member ReadJson : reader:JsonReader * objectType:Type * existingValue:obj * serializer:JsonSerializer -&gt; obj + 1 overload<br />&#160;&#160;member WriteJson : writer:JsonWriter * value:obj * serializer:JsonSerializer -&gt; unit + 1 overload<br /><br />--------------------<br />type JsonConverterAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : converterType:Type -&gt; JsonConverterAttribute + 1 overload<br />&#160;&#160;member ConverterParameters : obj[]<br />&#160;&#160;member ConverterType : Type<br /><br />--------------------<br />JsonConverter() : JsonConverter<br /><br />--------------------<br />JsonConverter() : JsonConverter&lt;&#39;T&gt;<br /><br />--------------------<br />JsonConverterAttribute(converterType: Type) : JsonConverterAttribute<br />JsonConverterAttribute(converterType: Type, [&lt;ParamArray&gt;] converterParameters: obj []) : JsonConverterAttribute</div>
<div class="tip" id="fs97">val w : JsonWriter</div>
<div class="tip" id="fs98">type JsonWriter =<br />&#160;&#160;member AutoCompleteOnClose : bool with get, set<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member CloseAsync : ?cancellationToken:CancellationToken -&gt; Task<br />&#160;&#160;member CloseOutput : bool with get, set<br />&#160;&#160;member Culture : CultureInfo with get, set<br />&#160;&#160;member DateFormatHandling : DateFormatHandling with get, set<br />&#160;&#160;member DateFormatString : string with get, set<br />&#160;&#160;member DateTimeZoneHandling : DateTimeZoneHandling with get, set<br />&#160;&#160;member FloatFormatHandling : FloatFormatHandling with get, set<br />&#160;&#160;member Flush : unit -&gt; unit<br />&#160;&#160;...</div>
<div class="tip" id="fs99">val v : IArticleContent</div>
<div class="tip" id="fs100">Multiple items<br />type JsonSerializer =<br />&#160;&#160;new : unit -&gt; JsonSerializer<br />&#160;&#160;member Binder : SerializationBinder with get, set<br />&#160;&#160;member CheckAdditionalContent : bool with get, set<br />&#160;&#160;member ConstructorHandling : ConstructorHandling with get, set<br />&#160;&#160;member Context : StreamingContext with get, set<br />&#160;&#160;member ContractResolver : IContractResolver with get, set<br />&#160;&#160;member Converters : JsonConverterCollection<br />&#160;&#160;member Culture : CultureInfo with get, set<br />&#160;&#160;member DateFormatHandling : DateFormatHandling with get, set<br />&#160;&#160;member DateFormatString : string with get, set<br />&#160;&#160;...<br /><br />--------------------<br />JsonSerializer() : JsonSerializer</div>
<div class="tip" id="fs101">val writePair : (string -&gt; string -&gt; unit)</div>
<div class="tip" id="fs102">val k : string</div>
<div class="tip" id="fs103">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />--------------------<br />type string = String</div>
<div class="tip" id="fs104">JsonWriter.WritePropertyName(name: string) : unit<br />JsonWriter.WritePropertyName(name: string, escape: bool) : unit</div>
<div class="tip" id="fs105">JsonWriter.WriteValue(value: obj) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Uri) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: byte []) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;TimeSpan&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;Guid&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;DateTimeOffset&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;DateTime&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;decimal&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;sbyte&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />JsonWriter.WriteValue(value: Nullable&lt;byte&gt;) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs106">JsonWriter.WriteStartObject() : unit</div>
<div class="tip" id="fs107">property IArticleContent.ContentType: string</div>
<div class="tip" id="fs108">property IArticleContent.Text: string</div>
<div class="tip" id="fs109">JsonWriter.WriteEndObject() : unit</div>
<div class="tip" id="fs110">val __ : IArticleContentConverter</div>
<div class="tip" id="fs111">val r : JsonReader</div>
<div class="tip" id="fs112">type JsonReader =<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member CloseInput : bool with get, set<br />&#160;&#160;member Culture : CultureInfo with get, set<br />&#160;&#160;member DateFormatString : string with get, set<br />&#160;&#160;member DateParseHandling : DateParseHandling with get, set<br />&#160;&#160;member DateTimeZoneHandling : DateTimeZoneHandling with get, set<br />&#160;&#160;member Depth : int<br />&#160;&#160;member FloatParseHandling : FloatParseHandling with get, set<br />&#160;&#160;member MaxDepth : Nullable&lt;int&gt; with get, set<br />&#160;&#160;member Path : string<br />&#160;&#160;...</div>
<div class="tip" id="fs113">val readIgnore : (unit -&gt; unit)</div>
<div class="tip" id="fs114">JsonReader.Read() : bool</div>
<div class="tip" id="fs115">val typ : string</div>
<div class="tip" id="fs116">JsonReader.ReadAsString() : string</div>
<div class="tip" id="fs117">val text : string</div>
<div class="tip" id="fs118">val content : IArticleContent</div>
<div class="tip" id="fs119">val x : string</div>
<div class="tip" id="fs120">val invalidOp : message:string -&gt; &#39;T</div>
<div class="tip" id="fs121">module UpdatedStore<br /><br />from Tres</div>
<div class="tip" id="fs122">File.ReadAllText(path: string) : string<br />File.ReadAllText(path: string, encoding: Text.Encoding) : string</div>
<div class="tip" id="fs123">JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string) : &#39;T<br />JsonConvert.DeserializeObject(value: string) : obj<br />JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string, settings: JsonSerializerSettings) : &#39;T<br />JsonConvert.DeserializeObject&lt;&#39;T&gt;(value: string, [&lt;ParamArray&gt;] converters: JsonConverter []) : &#39;T<br />JsonConvert.DeserializeObject(value: string, type: Type) : obj<br />JsonConvert.DeserializeObject(value: string, settings: JsonSerializerSettings) : obj<br />JsonConvert.DeserializeObject(value: string, type: Type, settings: JsonSerializerSettings) : obj<br />JsonConvert.DeserializeObject(value: string, type: Type, [&lt;ParamArray&gt;] converters: JsonConverter []) : obj</div>
<div class="tip" id="fs124">val store : DocumentStore</div>
<div class="tip" id="fs125">Multiple items<br />type X509Certificate2 =<br />&#160;&#160;inherit X509Certificate<br />&#160;&#160;new : unit -&gt; X509Certificate2 + 12 overloads<br />&#160;&#160;member Archived : bool with get, set<br />&#160;&#160;member Extensions : X509ExtensionCollection<br />&#160;&#160;member FriendlyName : string with get, set<br />&#160;&#160;member GetNameInfo : nameType:X509NameType * forIssuer:bool -&gt; string<br />&#160;&#160;member HasPrivateKey : bool<br />&#160;&#160;member Import : rawData:byte[] -&gt; unit + 5 overloads<br />&#160;&#160;member IssuerName : X500DistinguishedName<br />&#160;&#160;member NotAfter : DateTime<br />&#160;&#160;member NotBefore : DateTime<br />&#160;&#160;...<br /><br />--------------------<br />X509Certificate2() : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte []) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(handle: nativeint) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(certificate: X509Certificate) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: Security.SecureString) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: string) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: Security.SecureString) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string, keyStorageFlags: X509KeyStorageFlags) : X509Certificate2<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs126">property DocumentStoreBase.Conventions: Conventions.DocumentConventions</div>
<div class="tip" id="fs127">property Conventions.DocumentConventions.CustomizeJsonSerializer: Action&lt;JsonSerializer&gt;</div>
<div class="tip" id="fs128">val x : JsonSerializer</div>
<div class="tip" id="fs129">property JsonSerializer.Converters: JsonConverterCollection</div>
<div class="tip" id="fs130">Collections.ObjectModel.Collection.Add(item: JsonConverter) : unit</div>
<div class="tip" id="fs131">DocumentStore.Initialize() : IDocumentStore</div>

        </div>
        <div class="span3">
          <img src="/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">objects |> functions</li>
            <li><a href="/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="https://github.com/bit-badger/o2f">Source Code on GitHub</a></li>
            <li><a href="/license.html">License</a></li>
            <li class="divider"></li>
            <li class="nav-header">Steps</li>
            <li><a href="/step0.html"><strong>0 |> Environment</strong></a></li>
            <li><a href="/step1/"><strong>1 |> Hello World</strong></a></li>
            <li><a href="/step2/"><strong>2 |> Data Model</strong></a></li>
            <li><a href="/step3/"><strong>3 |> RavenDB Connection</strong></a></li>
            <li><a href="/step4/"><strong>4 |> Framework Setup</strong></a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="https://github.com/bit-badger/o2f"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
